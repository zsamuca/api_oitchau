(EmployeeUuid as text, DataConsulta as date) =>
let
    Host = "https://api.oitchau.com.br",
    Token = Token_Oitchau,

    UrlResponse =
        Web.Contents(
            Host,
            [
                RelativePath = "v2/public/integrations_api/employees/hoursbank/totals",
                Query = [
                    employeeUuid = EmployeeUuid,
                    date = Date.ToText(DataConsulta, "yyyy-MM-dd")
                ],
                Headers = [
                    Authorization = "Bearer " & Token,
                    Accept = "application/json"
                ],
                ManualStatusHandling = {400,401,403,404,408,429,500,502,503,504}
            ]
        ),

    Status = Value.Metadata(UrlResponse)[Response.Status],
    BodyText = try Text.FromBinary(UrlResponse) otherwise null,
    Json = try Json.Document(UrlResponse) otherwise null,

    Totals = try Json[totals] otherwise null,
    ValuesList = if Totals = null then {} else Record.FieldValues(Totals),

    GetNum = (r as any, fieldName as text) as number =>
        let
            v = try Record.Field(r, fieldName) otherwise null,
            n = try Number.From(v) otherwise null
        in
            if n = null then 0 else n,

    SumNeg = List.Sum(List.Transform(ValuesList, each GetNum(_, "negative"))),
    SumPos = List.Sum(List.Transform(ValuesList, each GetNum(_, "positive"))),
    SaldoMinutos = SumNeg + SumPos,

    Resultado = [
        status = Status,
        saldoMinutos = SaldoMinutos,
        body = BodyText
    ]
in
    Resultado
